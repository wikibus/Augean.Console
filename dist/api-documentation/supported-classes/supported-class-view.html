<link rel="import" href="../../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../supported-properties/supported-property-view.html">
<link rel="import" href="../supported-operations/supported-operations-viewer.html">
<dom-module id="supported-class-view">
  <template>
    <style>
      paper-card {
        width: 100%;
      }

      [hidden] {
        display: none;
      }
    </style>
    <paper-tabs id="classTabs" selected="{{classTab}}">
      <paper-tab>Description</paper-tab>
      <paper-tab>Properties</paper-tab>
      <paper-tab>Operations</paper-tab>
    </paper-tabs>

    <paper-card>
      <div class="card-content">
        <iron-pages selected="{{classTab}}">
          <p>
            [[supportedClass.description]]
          </p>

          <div>
            <div hidden$="[[!hasProperties]]">
              <vaadin-combo-box label="Supported Property" item-value-path="id" item-label-path="title" items="[[supportedClass.supportedProperties]]" selected-item="{{selectedProperty}}" id="supportedProperties">
              </vaadin-combo-box>

              <supported-property-view supported-property="[[selectedProperty]]" hidden$="[[!propertyIsSelected]]"></supported-property-view>
            </div>
            <div hidden$="[[hasProperties]]">
              No supported properties do display
            </div>
          </div>

          <div>
            <div hidden$="[[!hasOperations]]">
              <supported-operations-viewer id="operations" supported-operations="[[supportedClass.supportedOperations]]"></supported-operations-viewer>
            </div>

            <div hidden$="[[hasOperations]]">
              No supported operations do display
            </div>
          </div>
        </iron-pages>
      </div>
    </paper-card>
  </template>
  <script>
    class SupportedClassView extends Polymer.Element {
      static get is() {
        return 'supported-class-view';
      }
      static get properties() {
        return {
          supportedClass: {
            type: Object,
            observer: 'getProperties'
          },
          selectedProperty: Object,
          propertyIsSelected: {
            type: Boolean,
            readOnly: true,
            computed: '_propertyIsSelected(selectedProperty)'
          },
          hasProperties: {
            type: Boolean,
            computed: '_hasProperties(supportedClass)'
          },
          hasOperations: {
            type: Boolean,
            computed: '_hasOperations(supportedClass)'
          }
        };
      }
      _propertyIsSelected(selectedProperty) {
        return typeof selectedProperty !== 'undefined' && selectedProperty !== null;
      }
      _hasProperties(supportedClass) {
        if (!supportedClass) {
          return false;
        }
        return supportedClass.supportedProperties.length > 0;
      }
      _hasOperations(supportedClass) {
        if (!supportedClass) {
          return false;
        }
        return supportedClass.supportedOperations.length > 0;
      }
      attached() {
        this.$.classTabs.select(0);
      }
      getProperties(supportedClass) {
        this.$.supportedProperties.value = null;
        this.$.classTabs.selected = 0;
      }
      openProperties() {
        this.$.props.toggle();
      }
    }
    customElements.define(SupportedClassView.is, SupportedClassView);
  </script>
</dom-module>
